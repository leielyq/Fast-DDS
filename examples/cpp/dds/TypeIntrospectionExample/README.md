# Type Introspection Example

This example shows two different features of Fast DDS related with Dynamic Types:

* How to use different kind of Data Types from a Publisher point of view.
  In order to publish messages with specific data type, there are several ways to define the type:
  * Using IDL file defining the type and autogenerating code using Fast-DDS-Gen
  * Using XML type definition and loading type with `XMLProfileManager`
  * Defining type by code using Dynamic Types API

* How to create a generic Subscriber that is able to create a DataReader independently the Data Type.
  In order to do this, the type must be registered in the Participant, and this only possible if the Publisher
  is configured to share the Data Type information.
  The Dynamic Types API provides methods to introspect a data type to get data members names and values.

## Execution instructions

To launch this test open two different consoles:

In the first one launch: ./TypeIntrospectionExample publisher (or TypeIntrospectionExample.exe publisher on windows).
In the second one: ./TypeIntrospectionExample subscriber (or TypeIntrospectionExample.exe subscriber on windows).

## Arguments

First argument is `publisher` or `subscriber` and then the rest of arguments are read unordered

```sh
Usage: TypeIntrospectionExample <publisher|subscriber>

General options:
  -h                    --help
                          Produce help message.

Publisher options:
  -t <topic_name>       --topic=<topic_name>
                          Topic name (Default: HelloWorldTopic).
  -x <data_type_name>   --type=<data_type_name>
                          Topic Data Type name (Default: hw).
  -g <generator_name>   --generator=<gen|xml|code>
                          Data Type Generator (Default: gen).
  -d <id>               --domain=<id>
                          DDS domain ID (Default: 0).
  -s <num>              --samples=<num>
                          Number of samples to send (Default: 0 => infinite samples).
  -i                    --type-information
                          Use Type Information to send Data Type Introspection info. (Default).
  -o                    --type-object
                          Use Type Object to send Data Type Introspection info.

Subscriber options:
  -t <topic_name>       --topic=<topic_name>
                          Topic name (Default: HelloWorldTopic).
  -d <id>               --domain=<id>
                          DDS domain ID (Default: 0).
  -s <num>              --samples=<num>
                          Number of samples to wait for (Default: 0 => infinite samples).
  -i                    --type-information
                          Use Type Information to send Data Type Introspection info (Default).
                        --type-information-disable
                          Deactivate Type Information to send Data Type Introspection info.
  -o                    --type-object
                          Use Type Object to send Data Type Introspection info.

```

### Publisher Data Type

The Publisher has an argument `type`.
Depending on this argument, the Publisher will create a DataWriter using different Data Types.
Each of the types available are registered in the Participant in different ways, to illustrate how this could
be done.

This Data Types are:

- hw: HelloWorld data type (one string and one integer).
- array: Data type with an array (one uint and an array of size 3 integer).
- seq: Data type with a sequence (one uint and a sequence of size 3 shorts).
- struct: Complex data type with an internal struct (3 integers).
- plain: HelloWorld struct (index and string) but string is an array of 20 chars, so data type is Plain.
- key: Struct with an index, a keyed string value and 1 integer.
- complex_array: Data type with an array of non-primitive objects.
- complex_seq: Data type with a sequence of non-primitive objects.
- super_complex: Complex data type composed of several of the other types at multiple levels.

### Subscriber Data Type

The Subscriber will detect the data type name and will register the type by the information sent by the
publisher, so the subscriber does not need to know the type.
In order to introspect a Data Type, just launch the Subscriber with the topic name and the domain ID of a Data Writer
that uses this Data Type (be sure the Publisher is configured to transmit Data Type introspection information).

---

## Useful Commands

### Generate autogenerated code from Fast DDS Gen

```sh
./src/fastddsgen/scripts/fastddsgen -replace  -d src/fastdds/examples/cpp/dds/TypeIntrospectionExample/types/hello_world/gen/ -typeobject -cs src/fastdds/examples/cpp/dds/TypeIntrospectionExample/types/hello_world/HelloWorld.idl
```
